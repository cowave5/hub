<?xml version="1.0" encoding="UTF-8" ?>
<!--

    Copyright (c) 2017ï½ž2099 Cowave All Rights Reserved.

    For licensing information, please contact: https://www.cowave.com.

    This code is proprietary and confidential.
    Unauthorized copying of this file, via any medium is strictly prohibited.

-->
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cowave.sys.blog.api.mapper.CommentMapper">

    <select id="queryByPostId" resultType="com.cowave.sys.blog.api.entity.PostComment">
        SELECT  id,
                p_id as pId,
                nick_name as nickName,
                avatar,
                content,
                parent_nick_name as parentNickName,
                create_time as createTime,
                ip_addr as ipAddr,
                (select 1 from post_comment c where c.p_id = post_comment.id limit 1) as below
        FROM  post_comment
        WHERE post_id = #{postId} and p_id = 0 and status = 1
        ORDER BY COALESCE(examine_time, create_time) DESC
    </select>

    <select id="queryByPid" resultType="com.cowave.sys.blog.api.entity.PostComment">
        SELECT  id,
                p_id as pId,
                nick_name as nickName,
                avatar, content,
                parent_nick_name as parentNickName,
                create_time as createTime,
                ip_addr as ipAddr
        FROM post_comment
        WHERE p_id = #{idList} and status = 1 ORDER BY create_time asc limit 10
    </select>
</mapper>
